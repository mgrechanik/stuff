# Рецепт как собрать Grid и Crud функционал вокруг ресурса в приложении Vue.js версии 2

[English version](../README.md)

## Содержание

* [Цель](#goal)
* [Демо](#demo)
* [Установка демо](#installing)
* [Объяснение по сборке](#explanation)




---

## Цель <span id="goal"></span>

Данный рецепт показывает план по которому можно легко собрать следующий функционал:

1. Предположим что на backend-е вы имеете некий ресурс, доступный к просмотру и управлению через Rest Api
2. Назовем этот ресурс моделью, как привычно называют в Yii объекты, отображающие строки в таблице базы данных 
3. Теперь вам нужен функционал для просмотра списка таких моделей и CRUD для них
4. Следуя этому рецепту вы получите быстрый старт для запуска следующего функционала вокруг управления моделью:

    * Страница списка моделей со следующими функциями:
	  * на странице показываются только модели, соответствующие условиям фильтрации, сортировки и нужной страницы пагинации
	  * с сервера грузятся только нужные для показа текущей страницы модели, т.е. мы **не** грузим перед работой **все** ресурсы из API
	  * когда условия для показа моделей текущей страницы меняются (фильтрация или сортировка), то следует новый запрос к API за нужными ресурсами
	  * строка сортировки позволяет для каждого столбца возможность сортировки по нему
	  * строка фильтрации ограничивает показываемые записи, с возможностью валидации данных в фильтре
    * Технически состояние модели хранится в отдельном модуле у VUEX
	* Функционал ```CRUD``` обеспечивает показ формы редактирования модели и ее удаления
	* Все легко меняется под нужные требования

---

## Демо <span id="demo"></span>

Данный **функционал** по умолчанию будет выглядеть так:
![получившийся функционал списка категорий](https://raw.githubusercontent.com/mgrechanik/yii2-categories-and-tags/master/docs/images/categories.png "Функционал дерева категорий")
	
---
    
## Установка демо <span id="installing"></span>

Клонируйте репозитарий

Выполните
```
npm install
```

Запускаем endpoint с базой
```
json-server --watch ./db/crud_db.json
```

Это даст вам два ресурса по следующим адресам:

```
  Resources
  http://localhost:3000/omegas
  http://localhost:3000/profiles
```

Запускайте приложение

```
npm run serve
```

Теперь вы будете видеть соответствующие grid-ы с crud функционалом

---

## Объяснение по сборке  <span id="explanation"></span> 

В деталях сборки вы можете ознакомиться в рабочем demo примере.

Основные моменты такие:

1) 
Функционал относительно vuex модуля располагается в ```src/store/имяМодуля.js```.

Функционал компонентов располагается в ```src/components/crud/имяМодуля/```.

2) В сборке присутствует модель omega - это базовая модель, от которой наследуется весь функционал.

Соответственно модуль omega ее обслуживвает.

3) Модель profile в сборке - как раз пример как можно создать свою собственную модель, отнаследовав ее от omega.

### Список шагов, необходимых для создания своей модели и модуля для нее

Допустим, мы назовем нашу модель zeta.

1) копируем ```components/crud/profile``` в ```components/crud/zeta```

2) Часть касаемая vuex модуля (каталог src/store)

    2.1) ```profile.js``` копируем в ```zeta.js```
	   2.1.1) В ```zeta.js```
	     - меняем на свои колонки фильтровки и сортировки (те, по которым в новой модели требуется)
	2.2) добавляем в ```store/index.js```
	```
		import zeta from './zeta'
		import * as ZETA_SETTINGS from '@/components/crud/zeta/_moduleSettings';

		zeta.state.settings = ZETA_SETTINGS;

		modules: {
			omega,
			profile,
			zeta
		}
		```
		
3) меняем ```components/crud/zeta```

3.1)_moduleSettings.js
  - настройки для данной модели
  
3.2) EditForm.vue
```
  - свои колонки
    - шаблон
	-   data: function() {
			return {
				model: {
```				
3.3)FilterRow.vue
```
    - шаблон
	-
	data: function() {
		return {
			filter: {	
```			
3.4)GridView.vue
  - шаблон

3.5)TitleAndSortRow.vue	
```
   - шаблон
   -
	data: function() {
		return {
			sort: {    
```
3.5) Инициализацию добавить 
  - в App.vue
  ```
    this.$store.dispatch("zeta/initializeAction", this.$store);    
    this.$store.dispatch("zeta/setPageAction", 1);     
  ```	
  - или во вьюхе у роутера
  
4) Добавляем эти компоненты на нужные страницы, пример как в роутере подключили, смотри в Демо  